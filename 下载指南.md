# 下载指南 - 你需要哪些文件？

## 快速答案

### ⭐ 推荐：下载全部（最简单）

```bash
git clone https://github.com/your-repo/GNN_Compiler.git
```

**大小**: 仅 ~5 MB（比一张照片还小！）
**好处**:
- ✅ 所有功能都能用
- ✅ 不会缺文件
- ✅ 路径自动正确

---

## 如果只想测试Executor

### 最小文件集（~15个文件，<500 KB）

```
GNX_final/
├── project_paths.py                        ← 路径配置（必须）
│
├── compiler/                               ← 部分需要
│   ├── __init__.py
│   ├── utils/
│   │   ├── __init__.py
│   │   └── graph_loader.py                ← 加载数据集（必须）
│   └── output/
│       └── compilation_result.json         ← 编译结果（必须有！）
│
└── executer/                               ← 全部需要
    ├── __init__.py
    ├── executor.py
    ├── subgraph_executor.py
    ├── data_loader.py
    ├── model_manager.py
    ├── model_export_utils.py
    ├── ghost_node_handler.py
    └── test_executor.py
```

### 运行方式

```bash
cd executer
python test_executor.py
```

**前提条件**:
1. 必须有 `compilation_result.json`（由compiler生成）
2. 安装依赖：
   ```bash
   pip install torch torch-geometric torch-scatter onnxruntime numpy
   ```

---

## 如果只想测试Compiler

### 最小文件集（~20个文件，<1 MB）

```
GNX_final/
├── project_paths.py                        ← 路径配置（必须）
│
├── profiling/                              ← 部分需要
│   └── results/
│       └── lookup_table.json               ← Profiling数据（必须有！）
│
└── compiler/                               ← 全部需要
    ├── core/                               ← 所有算法
    ├── utils/                              ← 所有工具
    ├── compiler.py
    └── test_compiler_flickr.py
```

### 运行方式

```bash
cd compiler
python test_compiler_flickr.py
```

**输出**: `output/compilation_result.json`

---

## 完整流程（推荐）

### 下载全部文件

```bash
# 克隆仓库
git clone https://github.com/your-repo/GNN_Compiler.git
cd GNN_Compiler

# 安装依赖
pip install torch torch-geometric torch-scatter onnxruntime numpy scipy networkx metis

# 运行profiling（首次需要）
cd profiling
python profile_stages.py --all
cd ..

# 运行完整pipeline
python run_pipeline.py
```

---

## 文件依赖关系

### 数据流

```
1. Profiling
   └─→ profiling/results/lookup_table.json

2. Compiler（需要 lookup_table.json）
   └─→ compiler/output/compilation_result.json

3. Executor（需要 compilation_result.json）
   └─→ 最终推理结果
```

### 关键输入文件

#### `profiling/results/lookup_table.json`
- **生成方式**: 运行 `profiling/profile_stages.py --all`
- **用途**: Compiler用来估算延迟
- **大小**: ~50-100 KB

#### `compiler/output/compilation_result.json`
- **生成方式**: 运行 `compiler/test_compiler_flickr.py`
- **用途**: Executor用来执行推理
- **大小**: ~3-5 KB

---

## 文件大小参考

| 组件 | 文件数 | 大小 |
|------|--------|------|
| `project_paths.py` | 1 | 5 KB |
| `profiling/` | ~20 | 500 KB |
| `compiler/` | ~30 | 1 MB |
| `executer/` | ~15 | 300 KB |
| 文档 | ~15 | 500 KB |
| 脚本 | ~5 | 50 KB |
| **总计** | **~100** | **<5 MB** |

*不包括数据集（PyG会自动下载）*

---

## 检查清单

### Executor所需文件

```bash
# 检查文件是否存在
ls project_paths.py                     # 必须有
ls compiler/utils/graph_loader.py       # 必须有
ls compiler/output/compilation_result.json  # 必须有（由compiler生成）
ls executer/executor.py                 # 必须有
ls executer/model_export_utils.py       # 必须有

# 测试导入
python -c "import project_paths; print('✓')"
python -c "from executer import PipelineExecutor; print('✓')"
```

### Compiler所需文件

```bash
# 检查文件是否存在
ls project_paths.py                     # 必须有
ls profiling/results/lookup_table.json  # 必须有（由profiling生成）
ls compiler/compiler.py                 # 必须有
ls compiler/core/global_optimizer.py    # 必须有

# 测试导入
python -c "import project_paths; print('✓')"
python -c "from compiler import GNNCompiler; print('✓')"
```

---

## 常见问题

### Q: 缺少 `compilation_result.json` 怎么办？

**A**: 运行compiler生成：
```bash
cd compiler
python test_compiler_flickr.py
```

### Q: 缺少 `lookup_table.json` 怎么办？

**A**: 运行profiling生成：
```bash
cd profiling
python profile_stages.py --all
```

### Q: 数据集在哪里？

**A**: 不需要手动下载！PyTorch Geometric会在首次运行时自动下载Flickr数据集。

---

## 推荐方案

### 🌟 最佳选择：下载全部

```bash
git clone https://github.com/your-repo/GNN_Compiler.git
```

**理由**:
- 只有5 MB（非常小）
- 保证不缺文件
- 所有功能都能用
- 更新简单（`git pull`）

### 如果网速慢或空间有限

**方案1**: 只测试Executor + 已有`compilation_result.json`
- 下载: `project_paths.py` + `executer/` + `compiler/utils/graph_loader.py` + `compilation_result.json`
- 大小: ~15文件，<500 KB

**方案2**: 只测试Compiler + 已有`lookup_table.json`
- 下载: `project_paths.py` + `compiler/` + `lookup_table.json`
- 大小: ~20文件，<1 MB

---

## 快速对比

| 需求 | 需要下载 | 文件数 | 大小 |
|------|---------|--------|------|
| **只测试Executor** | `executer/` + 部分compiler + `compilation_result.json` | ~15 | <500 KB |
| **只测试Compiler** | `compiler/` + `lookup_table.json` | ~20 | <1 MB |
| **完整流程** | 全部文件 | ~100 | <5 MB |
| **只看代码** | `*.md` + `*.py` | ~70 | <2 MB |

---

## 总结

### 最简单的方式 ✨

```bash
git clone <仓库地址>
cd GNN_Compiler
pip install torch torch-geometric torch-scatter onnxruntime numpy scipy networkx metis
python run_pipeline.py
```

**就这么简单！** 🎉

---

## 更多信息

详细文档请看：
- `README.md` - 项目总览
- `DOWNLOAD_GUIDE.md` - 英文详细下载指南
- `FILE_DEPENDENCIES.md` - 文件依赖关系图
- `PATH_INTEGRATION.md` - 模块集成说明
