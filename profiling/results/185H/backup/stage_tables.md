# Stage Profiling Tables

Generated from `lookup_table.json`

**注意**: Stage 2 (MESSAGE) 时间异常高，可能是旧版本代码生成的数据。
当前代码中 Stage 2 应该是 identity 操作。

---

## Summary: 100k Nodes Performance Comparison

*Using 100k nodes, 1M edges for stages 1-4; 100k nodes for stages 5-7*

| Stage | Description | CPU | GPU | NPU | GPU Speedup | NPU Speedup |
|-------|-------------|-----|-----|-----|-------------|-------------|
| 1 | GATHER | 1.02s | 158.5 | 361.9 | 6.4x | 2.8x |
| 2 | MESSAGE | 581.94s | 105.49s | 255.88s | 5.5x | 2.3x |
| 3 | REDUCE_SUM | 1.71s | 308.0 | 679.5 | 5.5x | 2.5x |
| 4 | REDUCE_COUNT | 579.3 | 106.2 | 243.8 | 5.5x | 2.4x |
| 5 | NORMALIZE | 50.70 | 8.083 | 19.33 | 6.3x | 2.6x |
| 6 | TRANSFORM | 76.21s | 12.36s | 33.99s | 6.2x | 2.2x |
| 7 | ACTIVATE | 32.26 | 4.990 | 13.58 | 6.5x | 2.4x |

---

## Stage 1: GATHER (Neighbor Feature Gathering)

*依赖 nodes 和 edges*

### CPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 5.143 | 9.423 | 19.16 | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 25.74 | 50.76 | 95.46 | - | - | - | - | - | - |
| 10k | - | - | - | - | 51.12 | 100.5 | 201.5 | - | - | - | - | - |
| 20k | - | - | - | - | - | 86.05 | 197.9 | - | 407.3 | - | - | - |
| 50k | - | - | - | - | - | - | - | 229.5 | - | 451.9 | 997.7 | - |
| 100k | - | - | - | - | - | - | - | - | - | 511.9 | 1.02s | 1.98s |

### GPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 1.131 | 2.056 | 3.332 | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 4.519 | 8.421 | 16.03 | - | - | - | - | - | - |
| 10k | - | - | - | - | 7.999 | 14.85 | 31.82 | - | - | - | - | - |
| 20k | - | - | - | - | - | 14.48 | 28.26 | - | 57.92 | - | - | - |
| 50k | - | - | - | - | - | - | - | 39.12 | - | 72.08 | 153.0 | - |
| 100k | - | - | - | - | - | - | - | - | - | 73.53 | 158.5 | 308.0 |

### NPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 2.219 | 4.217 | 8.171 | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 10.01 | 17.54 | 36.78 | - | - | - | - | - | - |
| 10k | - | - | - | - | 18.83 | 34.84 | 75.65 | - | - | - | - | - |
| 20k | - | - | - | - | - | 38.25 | 69.77 | - | 151.5 | - | - | - |
| 50k | - | - | - | - | - | - | - | 84.84 | - | 171.6 | 354.7 | - |
| 100k | - | - | - | - | - | - | - | - | - | 205.5 | 361.9 | 683.5 |

---

## Stage 2: MESSAGE (⚠️ Identity - Check if data is outdated)

*依赖 nodes 和 edges*

### CPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 2.87s | 6.15s | 12.85s | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 15.02s | 34.21s | 67.89s | - | - | - | - | - | - |
| 10k | - | - | - | - | 33.76s | 60.72s | 120.59s | - | - | - | - | - |
| 20k | - | - | - | - | - | 64.05s | 117.63s | - | 236.18s | - | - | - |
| 50k | - | - | - | - | - | - | - | 166.22s | - | 309.02s | 618.65s | - |
| 100k | - | - | - | - | - | - | - | - | - | 300.37s | 581.94s | 1305.46s |

### GPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 468.3 | 1.00s | 1.85s | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 2.70s | 5.38s | 9.71s | - | - | - | - | - | - |
| 10k | - | - | - | - | 4.72s | 10.53s | 18.36s | - | - | - | - | - |
| 20k | - | - | - | - | - | 10.17s | 19.62s | - | 39.31s | - | - | - |
| 50k | - | - | - | - | - | - | - | 23.65s | - | 47.26s | 106.20s | - |
| 100k | - | - | - | - | - | - | - | - | - | 53.17s | 105.49s | 213.92s |

### NPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 1.31s | 2.46s | 4.73s | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 6.48s | 12.84s | 26.25s | - | - | - | - | - | - |
| 10k | - | - | - | - | 12.73s | 26.52s | 53.53s | - | - | - | - | - |
| 20k | - | - | - | - | - | 26.87s | 50.39s | - | 107.02s | - | - | - |
| 50k | - | - | - | - | - | - | - | 63.85s | - | 133.61s | 235.36s | - |
| 100k | - | - | - | - | - | - | - | - | - | 129.25s | 255.88s | 471.56s |

---

## Stage 3: REDUCE_SUM (Sum Aggregation)

*依赖 nodes 和 edges*

### CPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 8.803 | 18.90 | 35.53 | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 42.53 | 98.64 | 188.2 | - | - | - | - | - | - |
| 10k | - | - | - | - | 102.0 | 185.3 | 359.3 | - | - | - | - | - |
| 20k | - | - | - | - | - | 189.6 | 382.8 | - | 819.3 | - | - | - |
| 50k | - | - | - | - | - | - | - | 511.4 | - | 932.5 | 1.79s | - |
| 100k | - | - | - | - | - | - | - | - | - | 898.9 | 1.71s | 3.85s |

### GPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 2.019 | 3.222 | 6.449 | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 7.444 | 16.49 | 28.33 | - | - | - | - | - | - |
| 10k | - | - | - | - | 16.31 | 29.54 | 57.82 | - | - | - | - | - |
| 20k | - | - | - | - | - | 30.38 | 63.57 | - | 113.3 | - | - | - |
| 50k | - | - | - | - | - | - | - | 82.42 | - | 163.4 | 286.7 | - |
| 100k | - | - | - | - | - | - | - | - | - | 161.2 | 308.0 | 643.9 |

### NPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 3.665 | 7.373 | 16.52 | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 18.75 | 40.28 | 69.09 | - | - | - | - | - | - |
| 10k | - | - | - | - | 38.78 | 74.42 | 139.6 | - | - | - | - | - |
| 20k | - | - | - | - | - | 77.09 | 146.1 | - | 311.0 | - | - | - |
| 50k | - | - | - | - | - | - | - | 174.5 | - | 371.2 | 812.0 | - |
| 100k | - | - | - | - | - | - | - | - | - | 358.5 | 679.5 | 1.54s |

---

## Stage 4: REDUCE_COUNT (Count Neighbors)

*依赖 nodes 和 edges*

### CPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 2.913 | 5.818 | 11.82 | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 15.90 | 30.02 | 64.67 | - | - | - | - | - | - |
| 10k | - | - | - | - | 32.72 | 62.18 | 132.4 | - | - | - | - | - |
| 20k | - | - | - | - | - | 65.08 | 124.5 | - | 257.0 | - | - | - |
| 50k | - | - | - | - | - | - | - | 148.5 | - | 282.3 | 567.4 | - |
| 100k | - | - | - | - | - | - | - | - | - | 308.4 | 579.3 | 1.35s |

### GPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 1.005 | 1.457 | 2.341 | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 3.016 | 5.544 | 11.10 | - | - | - | - | - | - |
| 10k | - | - | - | - | 5.651 | 11.37 | 20.97 | - | - | - | - | - |
| 20k | - | - | - | - | - | 11.45 | 20.90 | - | 38.69 | - | - | - |
| 50k | - | - | - | - | - | - | - | 23.69 | - | 54.93 | 100.4 | - |
| 100k | - | - | - | - | - | - | - | - | - | 46.04 | 106.2 | 215.5 |

### NPU

| Nodes | 5k | 10k | 20k | 25k | 50k | 100k | 200k | 250k | 400k | 500k | 1M | 2M |
|-------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 1k | 1.407 | 2.915 | 5.040 | - | - | - | - | - | - | - | - | - |
| 5k | - | - | - | 6.526 | 12.75 | 26.62 | - | - | - | - | - | - |
| 10k | - | - | - | - | 12.08 | 26.25 | 54.30 | - | - | - | - | - |
| 20k | - | - | - | - | - | 26.15 | 55.02 | - | 101.1 | - | - | - |
| 50k | - | - | - | - | - | - | - | 66.35 | - | 121.2 | 241.6 | - |
| 100k | - | - | - | - | - | - | - | - | - | 136.6 | 243.8 | 481.7 |

---

## Stage 5: NORMALIZE (Compute Mean)

*只依赖 nodes (edges 无影响)*

### CPU

| Nodes | Avg Time (ms) | Min | Max |
|-------|---------------|-----|-----|
| 1k | 0.619 | 0.599 | 0.652 |
| 5k | 2.660 | 2.564 | 2.717 |
| 10k | 5.141 | 4.610 | 5.588 |
| 20k | 10.08 | 9.743 | 10.66 |
| 50k | 26.21 | 24.79 | 27.05 |
| 100k | 49.03 | 47.50 | 50.70 |

### GPU

| Nodes | Avg Time (ms) | Min | Max |
|-------|---------------|-----|-----|
| 1k | 0.583 | 0.528 | 0.626 |
| 5k | 0.880 | 0.841 | 0.912 |
| 10k | 1.273 | 1.222 | 1.333 |
| 20k | 2.108 | 2.025 | 2.207 |
| 50k | 4.629 | 4.457 | 4.934 |
| 100k | 8.449 | 8.083 | 8.669 |

### NPU

| Nodes | Avg Time (ms) | Min | Max |
|-------|---------------|-----|-----|
| 1k | 0.502 | 0.462 | 0.524 |
| 5k | 1.273 | 1.179 | 1.399 |
| 10k | 2.324 | 2.266 | 2.391 |
| 20k | 4.132 | 4.072 | 4.195 |
| 50k | 10.11 | 9.348 | 10.89 |
| 100k | 20.64 | 19.33 | 21.39 |

---

## Stage 6: TRANSFORM (Linear Layer)

*只依赖 nodes (edges 无影响)*

### CPU

| Nodes | Avg Time (ms) | Min | Max |
|-------|---------------|-----|-----|
| 1k | 794.4 | 767.8 | 846.6 |
| 5k | 4.08s | 3.84s | 4.25s |
| 10k | 7.66s | 7.26s | 8.42s |
| 20k | 15.41s | 15.12s | 15.73s |
| 50k | 37.18s | 35.86s | 39.47s |
| 100k | 77.06s | 71.36s | 83.61s |

### GPU

| Nodes | Avg Time (ms) | Min | Max |
|-------|---------------|-----|-----|
| 1k | 133.3 | 130.7 | 136.5 |
| 5k | 646.0 | 605.4 | 668.6 |
| 10k | 1.25s | 1.13s | 1.33s |
| 20k | 2.43s | 2.30s | 2.58s |
| 50k | 6.42s | 6.27s | 6.62s |
| 100k | 12.17s | 11.62s | 12.54s |

### NPU

| Nodes | Avg Time (ms) | Min | Max |
|-------|---------------|-----|-----|
| 1k | 311.5 | 299.4 | 329.3 |
| 5k | 1.55s | 1.41s | 1.70s |
| 10k | 3.07s | 2.89s | 3.32s |
| 20k | 6.53s | 5.87s | 6.87s |
| 50k | 15.42s | 14.41s | 16.65s |
| 100k | 33.10s | 31.44s | 33.99s |

---

## Stage 7: ACTIVATE (ReLU)

*只依赖 nodes (edges 无影响)*

### CPU

| Nodes | Avg Time (ms) | Min | Max |
|-------|---------------|-----|-----|
| 1k | 0.425 | 0.409 | 0.445 |
| 5k | 1.621 | 1.524 | 1.686 |
| 10k | 3.216 | 2.914 | 3.455 |
| 20k | 6.329 | 6.086 | 6.598 |
| 50k | 15.18 | 14.32 | 16.52 |
| 100k | 31.32 | 29.64 | 32.26 |

### GPU

| Nodes | Avg Time (ms) | Min | Max |
|-------|---------------|-----|-----|
| 1k | 0.549 | 0.545 | 0.553 |
| 5k | 0.739 | 0.685 | 0.787 |
| 10k | 0.972 | 0.916 | 1.065 |
| 20k | 1.400 | 1.371 | 1.438 |
| 50k | 3.130 | 3.005 | 3.214 |
| 100k | 5.315 | 4.967 | 5.987 |

### NPU

| Nodes | Avg Time (ms) | Min | Max |
|-------|---------------|-----|-----|
| 1k | 0.430 | 0.389 | 0.467 |
| 5k | 0.920 | 0.865 | 0.978 |
| 10k | 1.465 | 1.415 | 1.512 |
| 20k | 2.756 | 2.624 | 2.901 |
| 50k | 6.320 | 5.950 | 6.874 |
| 100k | 13.37 | 12.63 | 13.89 |

---
