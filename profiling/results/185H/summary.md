# GNX Stage Profiling Summary (1k-150k nodes)

## 1. 数据概览

| 项目 | 数值 |
|------|------|
| 测试配置数 | 55 |
| 总测量数 | 1045 |
| CPU 测量 | 385 |
| GPU 测量 | 385 |
| NPU 测量 | 275 (Stage 3/4 跳过) |
| 节点范围 | 1k - 150k |
| 边数范围 | 2k - 1.5M |

## 2. NPU 可用性分析

NPU 在 **20k nodes, 200k edges** 时发生 `DEVICE_LOST` 错误，之后所有 NPU 测试失败。

### NPU 成功范围

| Stage | 成功测试数 | 最大成功配置 |
|-------|-----------|-------------|
| Stage 1 | 55 | 150k nodes, 1500k edges |
| Stage 2 | 55 | 150k nodes, 1500k edges |
| Stage 5 | 55 | 150k nodes, 1500k edges |
| Stage 6 | 55 | 150k nodes, 1500k edges |
| Stage 7 | 55 | 150k nodes, 1500k edges |

**结论**: NPU 仅支持小规模数据 (≤20k nodes, ≤140k edges)，实际 subgraph (37k-81k nodes) 超出 NPU 能力。

## 3. 各 Stage 详细延迟数据

### Stage 1: GATHER (edge indexing)
**复杂度**: O(E) - 边数主导

| Nodes | Edges | CPU (ms) | GPU (ms) | NPU (ms) | GPU加速 | NPU加速 |
|------:|------:|---------:|---------:|---------:|--------:|--------:|
| 1k | 2k | 4.33 | 2.83 | 4.72 | 1.53x | 0.92x |
| 1k | 3k | 6.30 | 3.88 | 6.68 | 1.63x | 0.94x |
| 1k | 5k | 5.72 | 4.44 | 15.66 | 1.29x | 0.36x |
| 1k | 7k | 8.03 | 6.19 | 11.18 | 1.30x | 0.72x |
| 1k | 10k | 7.92 | 8.70 | 19.78 | 0.91x | 0.40x |
| 5k | 10k | 15.57 | 10.08 | 19.94 | 1.54x | 0.78x |
| 5k | 15k | 14.82 | 13.32 | 31.09 | 1.11x | 0.48x |
| 5k | 25k | 20.78 | 21.28 | 61.39 | 0.98x | 0.34x |
| 5k | 35k | 28.63 | 27.62 | 96.50 | 1.04x | 0.30x |
| 5k | 50k | 41.60 | 40.32 | 166.67 | 1.03x | 0.25x |
| 10k | 20k | 16.60 | 19.71 | 54.51 | 0.84x | 0.30x |
| 10k | 30k | 25.57 | 28.13 | 91.30 | 0.91x | 0.28x |
| 10k | 50k | 43.50 | 41.09 | 190.55 | 1.06x | 0.23x |
| 10k | 70k | 55.58 | 63.10 | 332.17 | 0.88x | 0.17x |
| 10k | 100k | 60.56 | 82.79 | 605.17 | 0.73x | 0.10x |
| 20k | 40k | 22.35 | 35.94 | 135.98 | 0.62x | 0.16x |
| 20k | 60k | 43.10 | 50.93 | 258.73 | 0.85x | 0.17x |
| 20k | 100k | 75.31 | 86.66 | 625.51 | 0.87x | 0.12x |
| 20k | 140k | 107.56 | 109.59 | 1160.64 | 0.98x | 0.09x |
| 20k | 200k | 167.17 | 154.40 | 22.06 | 1.08x | 7.58x |
| 30k | 60k | 53.57 | 55.61 | 9.21 | 0.96x | 5.82x |
| 30k | 90k | 82.26 | 91.26 | 13.48 | 0.90x | 6.10x |
| 30k | 150k | 139.48 | 129.88 | 18.60 | 1.07x | 7.50x |
| 30k | 210k | 176.44 | 169.55 | 24.64 | 1.04x | 7.16x |
| 30k | 300k | 214.24 | 226.61 | 32.29 | 0.95x | 6.64x |
| 40k | 80k | 55.29 | 73.97 | 12.39 | 0.75x | 4.46x |
| 40k | 120k | 86.37 | 105.63 | 16.78 | 0.82x | 5.15x |
| 40k | 200k | 169.65 | 162.14 | 24.29 | 1.05x | 6.99x |
| 40k | 280k | 245.77 | 220.47 | 31.40 | 1.11x | 7.83x |
| 40k | 400k | 293.48 | 329.12 | 44.39 | 0.89x | 6.61x |
| 50k | 100k | 75.77 | 104.94 | 15.09 | 0.72x | 5.02x |
| 50k | 150k | 114.72 | 138.58 | 19.96 | 0.83x | 5.75x |
| 50k | 250k | 272.66 | 211.13 | 29.53 | 1.29x | 9.23x |
| 50k | 350k | 332.05 | 300.95 | 41.17 | 1.10x | 8.07x |
| 50k | 500k | 389.82 | 413.09 | 58.42 | 0.94x | 6.67x |
| 60k | 120k | 141.31 | 117.55 | 17.59 | 1.20x | 8.03x |
| 60k | 180k | 187.87 | 151.91 | 23.09 | 1.24x | 8.14x |
| 60k | 300k | 246.10 | 235.86 | 36.28 | 1.04x | 6.78x |
| 60k | 420k | 321.31 | 345.71 | 50.74 | 0.93x | 6.33x |
| 60k | 600k | 491.25 | 484.87 | 91.29 | 1.01x | 5.38x |
| 80k | 160k | 129.00 | 148.73 | 22.22 | 0.87x | 5.81x |
| 80k | 240k | 191.03 | 203.32 | 30.87 | 0.94x | 6.19x |
| 80k | 400k | 409.35 | 345.72 | 46.67 | 1.18x | 8.77x |
| 80k | 560k | 432.55 | 467.95 | 86.67 | 0.92x | 4.99x |
| 80k | 800k | 782.67 | 628.57 | 123.47 | 1.25x | 6.34x |
| 100k | 200k | 166.58 | 184.01 | 25.84 | 0.91x | 6.45x |
| 100k | 300k | 273.23 | 258.10 | 36.86 | 1.06x | 7.41x |
| 100k | 500k | 460.05 | 413.28 | 62.16 | 1.11x | 7.40x |
| 100k | 700k | 653.25 | 567.26 | 109.48 | 1.15x | 5.97x |
| 100k | 1000k | 836.97 | 786.81 | 156.11 | 1.06x | 5.36x |
| 150k | 300k | 269.57 | 290.44 | 37.87 | 0.93x | 7.12x |
| 150k | 450k | 347.53 | 412.59 | 56.57 | 0.84x | 6.14x |
| 150k | 750k | 684.74 | 634.23 | 108.60 | 1.08x | 6.31x |
| 150k | 1050k | 938.12 | 860.39 | 156.95 | 1.09x | 5.98x |
| 150k | 1500k | 1285.57 | 1184.02 | 255.10 | 1.09x | 5.04x |

new table
Nodes,Edges,CPU (ms),GPU (ms),NPU (ms),GPU加速,NPU加速
1k,2k,1.24,2.83,-,0.44x,-
1k,3k,1.71,3.99,-,0.43x,-
1k,5k,4.22,5.15,-,0.82x,-
1k,7k,5.73,7.67,-,0.75x,-
1k,10k,7.08,10.23,-,0.69x,-
5k,10k,9.10,12.81,-,0.71x,-
5k,15k,16.26,15.76,-,1.03x,-
5k,25k,21.63,25.24,-,0.86x,-
5k,35k,35.66,48.38,-,0.74x,-
5k,50k,41.48,54.61,-,0.76x,-
10k,20k,17.82,28.26,-,0.63x,-
10k,30k,27.31,35.07,-,0.78x,-
10k,50k,48.48,53.55,-,0.91x,-
10k,70k,69.18,89.66,-,0.77x,-
10k,100k,96.73,112.93,-,0.86x,-
20k,40k,40.42,44.90,-,0.90x,-
20k,60k,57.12,67.30,-,0.85x,-
20k,100k,116.98,133.37,-,0.88x,-
20k,140k,129.97,167.53,-,0.78x,-
20k,200k,186.99,212.19,-,0.88x,-
30k,60k,60.49,75.93,-,0.80x,-
30k,90k,95.48,123.96,-,0.77x,-
30k,150k,172.12,170.19,-,1.01x,-
30k,210k,219.43,236.53,-,0.93x,-
30k,300k,297.00,299.50,-,0.99x,-
40k,80k,92.15,100.66,-,0.92x,-
40k,120k,121.27,132.56,-,0.91x,-
40k,200k,206.64,186.16,-,1.11x,-
40k,280k,336.42,301.87,-,1.11x,-
40k,400k,481.03,433.55,-,1.11x,-
50k,100k,113.40,121.12,-,0.94x,-
50k,150k,202.40,138.70,-,1.46x,-
50k,250k,307.08,218.79,-,1.40x,-
50k,350k,332.86,312.80,-,1.06x,-
50k,500k,596.28,526.63,-,1.13x,-
60k,120k,140.18,164.63,-,0.85x,-
60k,180k,235.42,204.83,-,1.15x,-
60k,300k,401.30,358.74,-,1.12x,-
60k,420k,453.57,464.32,-,0.98x,-
60k,600k,767.21,624.18,-,1.23x,-
80k,160k,203.99,204.38,-,1.00x,-
80k,240k,360.71,260.87,-,1.38x,-
80k,400k,435.29,430.58,-,1.01x,-
80k,560k,692.96,684.44,-,1.01x,-
80k,800k,1056.82,787.07,-,1.34x,-
100k,200k,241.09,208.60,-,1.16x,-
100k,300k,395.33,350.12,-,1.13x,-
100k,500k,405.45,575.00,-,0.71x,-
100k,700k,678.64,737.52,-,0.92x,-
100k,1M,979.28,1129.69,-,0.87x,-
150k,300k,391.43,361.18,-,1.08x,-
150k,450k,560.75,561.17,-,1.00x,-
150k,750k,897.59,844.34,-,1.06x,-
150k,1.05M,1328.36,1153.06,-,1.15x,-
150k,1.5M,2161.55,1543.57,-,1.40x,-

### Stage 2: MESSAGE (identity)
**复杂度**: O(E) - 边数主导 (identity, ~0 cost)

| Nodes | Edges | CPU (ms) | GPU (ms) | NPU (ms) | GPU加速 | NPU加速 |
|------:|------:|---------:|---------:|---------:|--------:|--------:|
| 1k | 2k | 1.42 | 2.50 | 0.00 | 0.57x | 947.77x |
| 1k | 3k | 1.62 | 3.38 | 0.00 | 0.48x | 1236.96x |
| 1k | 5k | 3.83 | 5.49 | 0.00 | 0.70x | 3749.94x |
| 1k | 7k | 5.18 | 7.12 | 0.00 | 0.73x | 3905.83x |
| 1k | 10k | 7.92 | 9.42 | 0.00 | 0.84x | 3444.84x |
| 5k | 10k | 7.74 | 9.88 | 0.00 | 0.78x | 2982.17x |
| 5k | 15k | 9.55 | 14.46 | 0.00 | 0.66x | 8894.92x |
| 5k | 25k | 15.58 | 23.64 | 0.00 | 0.66x | 12210.77x |
| 5k | 35k | 21.83 | 32.54 | 0.00 | 0.67x | 20868.77x |
| 5k | 50k | 32.35 | 47.91 | 0.00 | 0.68x | 22465.93x |
| 10k | 20k | 12.27 | 18.67 | 0.00 | 0.66x | 9991.17x |
| 10k | 30k | 20.52 | 28.89 | 0.00 | 0.71x | 6473.74x |
| 10k | 50k | 33.20 | 50.15 | 0.00 | 0.66x | 24522.45x |
| 10k | 70k | 45.24 | 75.59 | 0.00 | 0.60x | 23538.93x |
| 10k | 100k | 65.41 | 101.38 | 0.00 | 0.65x | 61703.40x |
| 20k | 40k | 25.64 | 37.97 | 0.00 | 0.68x | 25742.68x |
| 20k | 60k | 39.15 | 58.33 | 0.00 | 0.67x | 17924.49x |
| 20k | 100k | 63.62 | 100.39 | 0.00 | 0.63x | 51556.29x |
| 20k | 140k | 81.95 | 135.34 | 0.00 | 0.61x | 79566.35x |
| 20k | 200k | 122.57 | 193.22 | 0.00 | 0.63x | 75012.17x |
| 30k | 60k | 35.16 | 60.65 | 0.00 | 0.58x | 34472.87x |
| 30k | 90k | 54.06 | 97.04 | 0.00 | 0.56x | 50811.85x |
| 30k | 150k | 90.64 | 149.57 | 0.00 | 0.61x | 72982.18x |
| 30k | 210k | 136.33 | 203.17 | 0.00 | 0.67x | 132360.96x |
| 30k | 300k | 197.70 | 298.75 | 0.00 | 0.66x | 86407.97x |
| 40k | 80k | 58.48 | 85.09 | 0.00 | 0.69x | 33418.90x |
| 40k | 120k | 76.07 | 117.73 | 0.00 | 0.65x | 70568.09x |
| 40k | 200k | 117.35 | 192.72 | 0.00 | 0.61x | 92693.10x |
| 40k | 280k | 164.87 | 277.74 | 0.00 | 0.59x | 121945.23x |
| 40k | 400k | 241.93 | 388.75 | 0.00 | 0.62x | 225256.63x |
| 50k | 100k | 60.74 | 101.32 | 0.00 | 0.60x | 60865.34x |
| 50k | 150k | 91.52 | 152.61 | 0.00 | 0.60x | 85053.63x |
| 50k | 250k | 154.61 | 249.67 | 0.00 | 0.62x | 148376.45x |
| 50k | 350k | 208.83 | 354.37 | 0.00 | 0.59x | 171733.89x |
| 50k | 500k | 306.23 | 470.21 | 0.00 | 0.65x | 283017.70x |
| 60k | 120k | 80.51 | 121.65 | 0.00 | 0.66x | 77863.06x |
| 60k | 180k | 119.88 | 171.80 | 0.00 | 0.70x | 115719.04x |
| 60k | 300k | 188.22 | 304.99 | 0.00 | 0.62x | 180979.89x |
| 60k | 420k | 249.64 | 398.93 | 0.00 | 0.63x | 158402.77x |
| 60k | 600k | 367.37 | 565.27 | 0.00 | 0.65x | 316157.24x |
| 80k | 160k | 103.41 | 152.36 | 0.00 | 0.68x | 47832.03x |
| 80k | 240k | 142.44 | 233.35 | 0.00 | 0.61x | 49908.21x |
| 80k | 400k | 240.24 | 388.09 | 0.00 | 0.62x | 224103.51x |
| 80k | 560k | 346.60 | 522.18 | 0.00 | 0.66x | 258273.23x |
| 80k | 800k | 455.40 | 733.71 | 0.00 | 0.62x | 266939.88x |
| 100k | 200k | 113.42 | 189.87 | 0.00 | 0.60x | 106197.23x |
| 100k | 300k | 186.95 | 298.91 | 0.00 | 0.63x | 125974.47x |
| 100k | 500k | 302.16 | 477.17 | 0.00 | 0.63x | 220875.32x |
| 100k | 700k | 410.99 | 653.65 | 0.00 | 0.63x | 384820.95x |
| 100k | 1000k | 607.81 | 908.92 | 0.00 | 0.67x | 501495.93x |
| 150k | 300k | 178.34 | 299.71 | 0.00 | 0.60x | 174162.95x |
| 150k | 450k | 273.95 | 432.96 | 0.00 | 0.63x | 268058.10x |
| 150k | 750k | 446.24 | 702.87 | 0.00 | 0.63x | 412424.70x |
| 150k | 1050k | 649.50 | 981.80 | 0.00 | 0.66x | 555130.83x |
| 150k | 1500k | 893.75 | 1348.42 | 0.00 | 0.66x | 630290.84x |

### Stage 3: REDUCE_SUM (scatter_add)
**复杂度**: O(E) - 边数主导 (稀疏)

| Nodes | Edges | CPU (ms) | GPU (ms) | GPU加速 |
|------:|------:|---------:|---------:|--------:|
| 1k | 2k | 3.08 | 2.79 | 1.11x |
| 1k | 3k | 3.89 | 3.08 | 1.26x |
| 1k | 5k | 6.01 | 3.82 | 1.57x |
| 1k | 7k | 8.52 | 4.83 | 1.77x |
| 1k | 10k | 13.03 | 6.18 | 2.11x |
| 5k | 10k | 17.69 | 9.51 | 1.86x |
| 5k | 15k | 25.58 | 12.17 | 2.10x |
| 5k | 25k | 32.47 | 16.04 | 2.02x |
| 5k | 35k | 38.43 | 21.06 | 1.82x |
| 5k | 50k | 50.09 | 28.58 | 1.75x |
| 10k | 20k | 58.87 | 17.50 | 3.36x |
| 10k | 30k | 82.84 | 23.66 | 3.50x |
| 10k | 50k | 122.31 | 32.76 | 3.73x |
| 10k | 70k | 186.48 | 43.28 | 4.31x |
| 10k | 100k | 84.89 | 53.78 | 1.58x |
| 20k | 40k | 62.72 | 35.73 | 1.76x |
| 20k | 60k | 89.56 | 43.57 | 2.06x |
| 20k | 100k | 133.61 | 64.13 | 2.08x |
| 20k | 140k | 564.71 | 82.55 | 6.84x |
| 20k | 200k | 256.18 | 110.24 | 2.32x |
| 30k | 60k | 99.98 | 52.90 | 1.89x |
| 30k | 90k | 124.01 | 70.13 | 1.77x |
| 30k | 150k | 427.97 | 101.30 | 4.22x |
| 30k | 210k | 303.42 | 128.35 | 2.36x |
| 30k | 300k | 531.82 | 167.27 | 3.18x |
| 40k | 80k | 236.91 | 69.73 | 3.40x |
| 40k | 120k | 204.71 | 88.31 | 2.32x |
| 40k | 200k | 441.01 | 127.94 | 3.45x |
| 40k | 280k | 503.92 | 163.27 | 3.09x |
| 40k | 400k | 845.86 | 221.07 | 3.83x |
| 50k | 100k | 236.15 | 88.49 | 2.67x |
| 50k | 150k | 376.91 | 115.57 | 3.26x |
| 50k | 250k | 500.46 | 164.14 | 3.05x |
| 50k | 350k | 776.29 | 216.38 | 3.59x |
| 50k | 500k | 962.03 | 273.53 | 3.52x |
| 60k | 120k | 288.44 | 103.95 | 2.77x |
| 60k | 180k | 426.28 | 130.31 | 3.27x |
| 60k | 300k | 556.85 | 188.53 | 2.95x |
| 60k | 420k | 1070.54 | 243.31 | 4.40x |
| 60k | 600k | 1072.29 | 324.95 | 3.30x |
| 80k | 160k | 591.44 | 142.06 | 4.16x |
| 80k | 240k | 548.25 | 177.02 | 3.10x |
| 80k | 400k | 699.95 | 253.23 | 2.76x |
| 80k | 560k | 1082.00 | 324.28 | 3.34x |
| 80k | 800k | 1419.79 | 434.87 | 3.26x |
| 100k | 200k | 487.53 | 176.03 | 2.77x |
| 100k | 300k | 599.87 | 220.38 | 2.72x |
| 100k | 500k | 1002.25 | 312.23 | 3.21x |
| 100k | 700k | 1525.13 | 405.16 | 3.76x |
| 100k | 1000k | 2059.76 | 539.12 | 3.82x |
| 150k | 300k | 817.23 | 261.96 | 3.12x |
| 150k | 450k | 1038.72 | 349.05 | 2.98x |
| 150k | 750k | 1742.67 | 497.93 | 3.50x |
| 150k | 1050k | 2143.50 | 644.94 | 3.32x |
| 150k | 1500k | 2654.14 | 824.67 | 3.22x |

### Stage 4: REDUCE_COUNT (scatter_add)
**复杂度**: O(E) - 边数主导 (稀疏)

| Nodes | Edges | CPU (ms) | GPU (ms) | GPU加速 |
|------:|------:|---------:|---------:|--------:|
| 1k | 2k | 0.19 | 0.76 | 0.26x |
| 1k | 3k | 0.25 | 0.76 | 0.33x |
| 1k | 5k | 0.20 | 0.72 | 0.28x |
| 1k | 7k | 0.26 | 0.82 | 0.32x |
| 1k | 10k | 0.29 | 0.85 | 0.34x |
| 5k | 10k | 0.50 | 0.70 | 0.71x |
| 5k | 15k | 0.30 | 0.80 | 0.37x |
| 5k | 25k | 0.41 | 0.82 | 0.50x |
| 5k | 35k | 0.48 | 0.73 | 0.65x |
| 5k | 50k | 0.56 | 0.75 | 0.75x |
| 10k | 20k | 0.48 | 0.83 | 0.58x |
| 10k | 30k | 0.41 | 0.72 | 0.57x |
| 10k | 50k | 0.57 | 0.71 | 0.80x |
| 10k | 70k | 0.60 | 0.88 | 0.67x |
| 10k | 100k | 0.77 | 0.87 | 0.89x |
| 20k | 40k | 0.51 | 0.95 | 0.53x |
| 20k | 60k | 0.65 | 0.94 | 0.69x |
| 20k | 100k | 0.76 | 0.86 | 0.89x |
| 20k | 140k | 1.77 | 0.89 | 1.98x |
| 20k | 200k | 2.54 | 1.00 | 2.55x |
| 30k | 60k | 0.61 | 0.93 | 0.66x |
| 30k | 90k | 0.80 | 1.02 | 0.78x |
| 30k | 150k | 1.97 | 1.14 | 1.73x |
| 30k | 210k | 2.78 | 1.15 | 2.43x |
| 30k | 300k | 3.76 | 1.37 | 2.74x |
| 40k | 80k | 0.70 | 0.90 | 0.78x |
| 40k | 120k | 1.39 | 1.02 | 1.37x |
| 40k | 200k | 2.58 | 1.21 | 2.13x |
| 40k | 280k | 3.52 | 1.32 | 2.66x |
| 40k | 400k | 5.24 | 1.77 | 2.95x |
| 50k | 100k | 0.86 | 0.87 | 0.98x |
| 50k | 150k | 1.96 | 1.20 | 1.64x |
| 50k | 250k | 3.16 | 1.36 | 2.32x |
| 50k | 350k | 4.45 | 1.50 | 2.97x |
| 50k | 500k | 6.27 | 1.94 | 3.23x |
| 60k | 120k | 1.34 | 0.92 | 1.46x |
| 60k | 180k | 2.23 | 1.19 | 1.88x |
| 60k | 300k | 3.84 | 1.42 | 2.70x |
| 60k | 420k | 5.45 | 1.58 | 3.46x |
| 60k | 600k | 7.73 | 2.15 | 3.60x |
| 80k | 160k | 2.17 | 1.13 | 1.91x |
| 80k | 240k | 3.14 | 1.35 | 2.32x |
| 80k | 400k | 5.32 | 1.63 | 3.26x |
| 80k | 560k | 7.43 | 2.27 | 3.28x |
| 80k | 800k | 10.48 | 2.81 | 3.73x |
| 100k | 200k | 2.57 | 1.53 | 1.68x |
| 100k | 300k | 4.02 | 1.33 | 3.02x |
| 100k | 500k | 6.69 | 2.05 | 3.26x |
| 100k | 700k | 9.21 | 2.46 | 3.74x |
| 100k | 1000k | 12.72 | 3.28 | 3.88x |
| 150k | 300k | 3.92 | 1.60 | 2.45x |
| 150k | 450k | 6.13 | 2.00 | 3.06x |
| 150k | 750k | 10.39 | 2.77 | 3.76x |
| 150k | 1050k | 14.18 | 3.49 | 4.06x |
| 150k | 1500k | 19.93 | 4.77 | 4.18x |

### Stage 5: NORMALIZE (division)
**复杂度**: O(N) - 节点数主导

| Nodes | Edges | CPU (ms) | GPU (ms) | NPU (ms) | GPU加速 | NPU加速 |
|------:|------:|---------:|---------:|---------:|--------:|--------:|
| 1k | 2k | 0.76 | 1.44 | 0.19 | 0.53x | 3.94x |
| 1k | 3k | 0.68 | 1.62 | 0.08 | 0.42x | 8.95x |
| 1k | 5k | 0.65 | 1.92 | 0.07 | 0.34x | 8.91x |
| 1k | 7k | 0.68 | 1.77 | 0.07 | 0.38x | 9.45x |
| 1k | 10k | 0.64 | 2.01 | 0.08 | 0.32x | 8.19x |
| 5k | 10k | 2.74 | 5.79 | 0.32 | 0.47x | 8.65x |
| 5k | 15k | 2.98 | 6.33 | 0.41 | 0.47x | 7.32x |
| 5k | 25k | 3.20 | 6.03 | 0.55 | 0.53x | 5.80x |
| 5k | 35k | 2.84 | 6.67 | 0.46 | 0.43x | 6.19x |
| 5k | 50k | 2.83 | 5.92 | 0.32 | 0.48x | 8.71x |
| 10k | 20k | 5.76 | 12.21 | 1.11 | 0.47x | 5.19x |
| 10k | 30k | 5.71 | 11.94 | 1.25 | 0.48x | 4.58x |
| 10k | 50k | 5.98 | 11.99 | 1.02 | 0.50x | 5.88x |
| 10k | 70k | 5.58 | 11.36 | 1.15 | 0.49x | 4.87x |
| 10k | 100k | 5.68 | 11.91 | 1.71 | 0.48x | 3.31x |
| 20k | 40k | 12.52 | 22.16 | 2.79 | 0.57x | 4.49x |
| 20k | 60k | 11.71 | 23.19 | 3.38 | 0.51x | 3.46x |
| 20k | 100k | 12.12 | 22.01 | 1.99 | 0.55x | 6.10x |
| 20k | 140k | 12.04 | 22.28 | 2.70 | 0.54x | 4.45x |
| 20k | 200k | 12.36 | 22.65 | 2.02 | 0.55x | 6.11x |
| 30k | 60k | 18.62 | 34.68 | 4.22 | 0.54x | 4.41x |
| 30k | 90k | 18.30 | 35.64 | 4.06 | 0.51x | 4.51x |
| 30k | 150k | 19.07 | 34.24 | 4.20 | 0.56x | 4.54x |
| 30k | 210k | 18.11 | 34.09 | 4.00 | 0.53x | 4.53x |
| 30k | 300k | 18.58 | 34.96 | 4.18 | 0.53x | 4.44x |
| 40k | 80k | 25.37 | 42.92 | 5.35 | 0.59x | 4.74x |
| 40k | 120k | 24.16 | 43.17 | 5.31 | 0.56x | 4.55x |
| 40k | 200k | 24.23 | 43.81 | 5.35 | 0.55x | 4.53x |
| 40k | 280k | 26.42 | 42.74 | 5.67 | 0.62x | 4.66x |
| 40k | 400k | 26.70 | 43.00 | 5.40 | 0.62x | 4.95x |
| 50k | 100k | 31.33 | 55.84 | 4.79 | 0.56x | 6.54x |
| 50k | 150k | 36.07 | 55.91 | 6.26 | 0.65x | 5.76x |
| 50k | 250k | 35.29 | 56.00 | 6.81 | 0.63x | 5.19x |
| 50k | 350k | 35.27 | 56.83 | 6.77 | 0.62x | 5.21x |
| 50k | 500k | 35.37 | 57.14 | 4.93 | 0.62x | 7.17x |
| 60k | 120k | 41.69 | 64.24 | 7.29 | 0.65x | 5.72x |
| 60k | 180k | 42.04 | 63.53 | 8.40 | 0.66x | 5.01x |
| 60k | 300k | 42.53 | 65.38 | 7.46 | 0.65x | 5.70x |
| 60k | 420k | 42.58 | 64.03 | 7.38 | 0.67x | 5.77x |
| 60k | 600k | 42.00 | 63.85 | 7.57 | 0.66x | 5.55x |
| 80k | 160k | 56.34 | 92.05 | 9.65 | 0.61x | 5.84x |
| 80k | 240k | 51.99 | 89.62 | 9.81 | 0.58x | 5.30x |
| 80k | 400k | 52.73 | 90.15 | 9.20 | 0.58x | 5.73x |
| 80k | 560k | 51.56 | 88.72 | 9.57 | 0.58x | 5.39x |
| 80k | 800k | 51.23 | 87.79 | 9.60 | 0.58x | 5.33x |
| 100k | 200k | 63.92 | 127.57 | 10.58 | 0.50x | 6.04x |
| 100k | 300k | 66.05 | 127.09 | 12.36 | 0.52x | 5.34x |
| 100k | 500k | 63.64 | 126.28 | 10.50 | 0.50x | 6.06x |
| 100k | 700k | 72.11 | 127.82 | 11.46 | 0.56x | 6.29x |
| 100k | 1000k | 79.21 | 125.06 | 11.32 | 0.63x | 7.00x |
| 150k | 300k | 116.98 | 195.35 | 17.07 | 0.60x | 6.85x |
| 150k | 450k | 118.25 | 195.12 | 16.62 | 0.61x | 7.12x |
| 150k | 750k | 112.49 | 195.52 | 16.28 | 0.58x | 6.91x |
| 150k | 1050k | 97.49 | 196.18 | 16.57 | 0.50x | 5.88x |
| 150k | 1500k | 95.06 | 195.28 | 16.87 | 0.49x | 5.63x |

### Stage 6: TRANSFORM (linear layer)
**复杂度**: O(N×F²) - 节点数主导 (密集)

| Nodes | Edges | CPU (ms) | GPU (ms) | NPU (ms) | GPU加速 | NPU加速 |
|------:|------:|---------:|---------:|---------:|--------:|--------:|
| 1k | 2k | 3.64 | 2.23 | 4.12 | 1.63x | 0.88x |
| 1k | 3k | 3.48 | 2.13 | 4.44 | 1.63x | 0.78x |
| 1k | 5k | 2.60 | 2.15 | 4.44 | 1.21x | 0.59x |
| 1k | 7k | 2.57 | 2.30 | 4.37 | 1.12x | 0.59x |
| 1k | 10k | 2.61 | 2.74 | 4.27 | 0.95x | 0.61x |
| 5k | 10k | 15.58 | 7.76 | 17.88 | 2.01x | 0.87x |
| 5k | 15k | 13.74 | 8.01 | 17.98 | 1.72x | 0.76x |
| 5k | 25k | 12.63 | 8.27 | 18.37 | 1.53x | 0.69x |
| 5k | 35k | 14.99 | 8.06 | 18.17 | 1.86x | 0.82x |
| 5k | 50k | 15.31 | 7.84 | 18.69 | 1.95x | 0.82x |
| 10k | 20k | 24.39 | 15.58 | 29.90 | 1.57x | 0.82x |
| 10k | 30k | 23.52 | 15.55 | 29.78 | 1.51x | 0.79x |
| 10k | 50k | 27.69 | 15.14 | 30.53 | 1.83x | 0.91x |
| 10k | 70k | 23.65 | 14.81 | 30.25 | 1.60x | 0.78x |
| 10k | 100k | 28.66 | 15.22 | 29.40 | 1.88x | 0.97x |
| 20k | 40k | 42.14 | 28.52 | 46.41 | 1.48x | 0.91x |
| 20k | 60k | 43.38 | 28.93 | 43.12 | 1.50x | 1.01x |
| 20k | 100k | 43.95 | 28.88 | 45.34 | 1.52x | 0.97x |
| 20k | 140k | 42.64 | 28.90 | 44.83 | 1.48x | 0.95x |
| 20k | 200k | 47.47 | 28.36 | 44.58 | 1.67x | 1.06x |
| 30k | 60k | 190.38 | 44.32 | 63.87 | 4.30x | 2.98x |
| 30k | 90k | 211.13 | 44.68 | 65.63 | 4.72x | 3.22x |
| 30k | 150k | 75.31 | 44.10 | 66.77 | 1.71x | 1.13x |
| 30k | 210k | 63.60 | 45.02 | 67.02 | 1.41x | 0.95x |
| 30k | 300k | 62.64 | 46.20 | 62.21 | 1.36x | 1.01x |
| 40k | 80k | 86.36 | 58.24 | 82.77 | 1.48x | 1.04x |
| 40k | 120k | 85.94 | 56.85 | 83.76 | 1.51x | 1.03x |
| 40k | 200k | 84.72 | 56.44 | 86.79 | 1.50x | 0.98x |
| 40k | 280k | 312.78 | 56.18 | 93.10 | 5.57x | 3.36x |
| 40k | 400k | 248.12 | 57.12 | 86.84 | 4.34x | 2.86x |
| 50k | 100k | 105.13 | 74.49 | 101.48 | 1.41x | 1.04x |
| 50k | 150k | 107.25 | 74.96 | 102.41 | 1.43x | 1.05x |
| 50k | 250k | 112.54 | 73.47 | 102.31 | 1.53x | 1.10x |
| 50k | 350k | 107.51 | 73.87 | 100.09 | 1.46x | 1.07x |
| 50k | 500k | 454.80 | 73.69 | 103.28 | 6.17x | 4.40x |
| 60k | 120k | 144.99 | 83.99 | 117.87 | 1.73x | 1.23x |
| 60k | 180k | 146.36 | 85.09 | 121.71 | 1.72x | 1.20x |
| 60k | 300k | 146.87 | 84.93 | 125.36 | 1.73x | 1.17x |
| 60k | 420k | 261.80 | 85.50 | 126.25 | 3.06x | 2.07x |
| 60k | 600k | 261.32 | 85.59 | 119.50 | 3.05x | 2.19x |
| 80k | 160k | 229.63 | 115.16 | 168.49 | 1.99x | 1.36x |
| 80k | 240k | 225.81 | 113.74 | 164.74 | 1.99x | 1.37x |
| 80k | 400k | 586.14 | 115.28 | 164.54 | 5.08x | 3.56x |
| 80k | 560k | 237.74 | 114.00 | 165.16 | 2.09x | 1.44x |
| 80k | 800k | 244.78 | 114.16 | 168.12 | 2.14x | 1.46x |
| 100k | 200k | 460.95 | 141.16 | 198.63 | 3.27x | 2.32x |
| 100k | 300k | 278.45 | 143.50 | 199.11 | 1.94x | 1.40x |
| 100k | 500k | 490.42 | 142.89 | 207.16 | 3.43x | 2.37x |
| 100k | 700k | 328.67 | 142.52 | 210.81 | 2.31x | 1.56x |
| 100k | 1000k | 370.67 | 139.74 | 197.65 | 2.65x | 1.88x |
| 150k | 300k | 546.44 | 219.72 | 302.75 | 2.49x | 1.80x |
| 150k | 450k | 571.23 | 221.74 | 320.86 | 2.58x | 1.78x |
| 150k | 750k | 461.06 | 222.14 | 289.43 | 2.08x | 1.59x |
| 150k | 1050k | 674.06 | 221.39 | 304.20 | 3.04x | 2.22x |
| 150k | 1500k | 440.07 | 221.62 | 297.33 | 1.99x | 1.48x |

Nodes (节点数),CPU 平均耗时 (ms),GPU 平均耗时 (ms),NPU 平均耗时 (ms)
1k,2.98,2.31,4.33
5k,14.45,7.99,18.22
10k,25.58,15.26,29.97
20k,43.92,28.72,44.86
30k,120.61,44.86,65.10
40k,163.58,56.97,86.65
50k,177.45,74.10,101.91
60k,192.27,85.02,122.14
80k,304.82,114.47,166.21
100k,385.83,141.96,202.67
150k,538.57,221.32,302.91

### Stage 7: ACTIVATE (ReLU)
**复杂度**: O(N) - 节点数主导

| Nodes | Edges | CPU (ms) | GPU (ms) | NPU (ms) | GPU加速 | NPU加速 |
|------:|------:|---------:|---------:|---------:|--------:|--------:|
| 1k | 2k | 0.66 | 1.26 | 0.03 | 0.52x | 19.88x |
| 1k | 3k | 0.64 | 1.13 | 0.04 | 0.57x | 16.36x |
| 1k | 5k | 0.62 | 1.25 | 0.03 | 0.49x | 21.32x |
| 1k | 7k | 0.65 | 1.52 | 0.25 | 0.42x | 2.55x |
| 1k | 10k | 0.61 | 1.39 | 0.24 | 0.44x | 2.56x |
| 5k | 10k | 2.84 | 5.46 | 1.08 | 0.52x | 2.63x |
| 5k | 15k | 2.66 | 5.05 | 0.90 | 0.53x | 2.95x |
| 5k | 25k | 2.79 | 5.50 | 0.81 | 0.51x | 3.43x |
| 5k | 35k | 2.87 | 5.04 | 0.91 | 0.57x | 3.14x |
| 5k | 50k | 2.96 | 5.25 | 0.78 | 0.56x | 3.78x |
| 10k | 20k | 5.71 | 9.95 | 1.75 | 0.57x | 3.26x |
| 10k | 30k | 5.94 | 10.16 | 1.74 | 0.58x | 3.41x |
| 10k | 50k | 5.92 | 9.84 | 1.42 | 0.60x | 4.18x |
| 10k | 70k | 5.72 | 9.95 | 1.70 | 0.57x | 3.36x |
| 10k | 100k | 6.12 | 10.27 | 1.37 | 0.60x | 4.48x |
| 20k | 40k | 14.09 | 18.57 | 3.73 | 0.76x | 3.77x |
| 20k | 60k | 13.28 | 18.99 | 3.23 | 0.70x | 4.11x |
| 20k | 100k | 12.93 | 18.23 | 2.26 | 0.71x | 5.72x |
| 20k | 140k | 12.52 | 18.54 | 3.22 | 0.68x | 3.89x |
| 20k | 200k | 12.46 | 19.36 | 2.40 | 0.64x | 5.18x |
| 30k | 60k | 18.78 | 29.30 | 4.79 | 0.64x | 3.92x |
| 30k | 90k | 25.26 | 28.44 | 4.84 | 0.89x | 5.22x |
| 30k | 150k | 24.27 | 28.79 | 4.73 | 0.84x | 5.13x |
| 30k | 210k | 23.86 | 28.76 | 4.94 | 0.83x | 4.83x |
| 30k | 300k | 24.25 | 28.65 | 4.96 | 0.85x | 4.89x |
| 40k | 80k | 45.80 | 37.71 | 6.08 | 1.21x | 7.53x |
| 40k | 120k | 31.74 | 37.52 | 6.51 | 0.85x | 4.87x |
| 40k | 200k | 31.19 | 38.37 | 5.84 | 0.81x | 5.34x |
| 40k | 280k | 32.91 | 37.72 | 6.13 | 0.87x | 5.37x |
| 40k | 400k | 33.46 | 37.13 | 5.78 | 0.90x | 5.79x |
| 50k | 100k | 39.84 | 47.69 | 7.85 | 0.84x | 5.08x |
| 50k | 150k | 39.89 | 47.38 | 6.57 | 0.84x | 6.07x |
| 50k | 250k | 40.14 | 47.64 | 6.62 | 0.84x | 6.07x |
| 50k | 350k | 41.32 | 47.72 | 6.73 | 0.87x | 6.14x |
| 50k | 500k | 32.21 | 47.26 | 5.57 | 0.68x | 5.78x |
| 60k | 120k | 37.76 | 55.68 | 7.93 | 0.68x | 4.76x |
| 60k | 180k | 38.71 | 54.52 | 7.85 | 0.71x | 4.93x |
| 60k | 300k | 38.03 | 54.81 | 7.70 | 0.69x | 4.94x |
| 60k | 420k | 38.45 | 58.19 | 7.80 | 0.66x | 4.93x |
| 60k | 600k | 37.28 | 56.08 | 7.87 | 0.66x | 4.74x |
| 80k | 160k | 53.48 | 87.26 | 9.44 | 0.61x | 5.66x |
| 80k | 240k | 52.28 | 84.62 | 9.85 | 0.62x | 5.31x |
| 80k | 400k | 52.74 | 84.61 | 9.28 | 0.62x | 5.68x |
| 80k | 560k | 53.92 | 83.46 | 9.95 | 0.65x | 5.42x |
| 80k | 800k | 60.69 | 87.49 | 9.87 | 0.69x | 6.15x |
| 100k | 200k | 73.83 | 102.26 | 11.89 | 0.72x | 6.21x |
| 100k | 300k | 73.90 | 100.83 | 11.88 | 0.73x | 6.22x |
| 100k | 500k | 72.55 | 100.94 | 11.82 | 0.72x | 6.14x |
| 100k | 700k | 72.35 | 100.72 | 12.63 | 0.72x | 5.73x |
| 100k | 1000k | 71.43 | 102.31 | 11.55 | 0.70x | 6.18x |
| 150k | 300k | 97.79 | 152.10 | 16.56 | 0.64x | 5.91x |
| 150k | 450k | 97.66 | 149.09 | 16.18 | 0.66x | 6.04x |
| 150k | 750k | 96.59 | 147.78 | 17.62 | 0.65x | 5.48x |
| 150k | 1050k | 98.76 | 149.97 | 17.23 | 0.66x | 5.73x |
| 150k | 1500k | 112.05 | 153.64 | 17.13 | 0.73x | 6.54x |

## 4. 性能总结

### 4.1 GPU vs CPU 加速比 (平均)

| Stage | 操作 | GPU 加速比 | 说明 |
|-------|------|-----------|------|
| Stage 1 | GATHER | 1.03x | GPU 略优 |
| Stage 2 | MESSAGE | 0.64x | CPU 更快 |
| Stage 3 | REDUCE_SUM | 2.91x | GPU 优势明显 |
| Stage 4 | REDUCE_COUNT | 1.90x | GPU 略优 |
| Stage 5 | NORMALIZE | 0.54x | CPU 更快 |
| Stage 6 | TRANSFORM | 2.22x | GPU 优势明显 |
| Stage 7 | ACTIVATE | 0.69x | CPU 更快 |

### 4.2 关键发现

1. **Stage 3 (REDUCE_SUM)**: GPU 加速最显著 (~3x)，scatter_add 操作 GPU 并行优势大
2. **Stage 6 (TRANSFORM)**: GPU 稳定 ~2x 加速，线性层计算密集
3. **Stage 2 (MESSAGE)**: Identity 操作，延迟极低 (~0ms)
4. **NPU 限制**: 仅支持 ≤20k nodes，大规模数据需用 CPU/GPU

## 5. 绘图数据 (推荐)

### 5.1 Stage 3 (稀疏操作) - 50k nodes, 变化 edges

```csv
edges,CPU_ms,GPU_ms
100000,236.15,88.49
150000,376.91,115.57
250000,500.46,164.14
350000,776.29,216.38
500000,962.03,273.53
```

### 5.2 Stage 6 (密集操作) - 变化 nodes (取 edge_ratio=5x)

```csv
nodes,CPU_ms,GPU_ms,NPU_ms
1000,2.60,2.15,4.44
5000,12.63,8.27,18.37
10000,27.69,15.14,30.53
20000,43.95,28.88,45.34
30000,75.31,44.10,66.77
40000,84.72,56.44,86.79
50000,112.54,73.47,102.31
60000,146.87,84.93,125.36
80000,586.14,115.28,164.54
100000,490.42,142.89,207.16
150000,461.06,222.14,289.43
```
